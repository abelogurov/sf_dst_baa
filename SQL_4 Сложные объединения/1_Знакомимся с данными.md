### Таблица city — это справочник городов. Структура справочника представлена ниже.

НАЗВАНИЕ ПОЛЯ	ТИП ДАННЫХ	ОПИСАНИЕ
city_id	        integer	    уникальный идентификатор города, первичный ключ
city_name	    text	    название города
state	        text	    штат, к которому относится город
population	    integer	    население города
area	        numeric	    площадь города

### Таблица customer — это справочник клиентов. У компании, с данными которой мы работаем, только корпоративные клиенты, поэтому в таблице нет привычных данных о возрасте и поле. Справочник содержит следующие поля:

НАЗВАНИЕ ПОЛЯ	ТИП ДАННЫХ	ОПИСАНИЕ
cust_id	        integer	    уникальный идентификатор клиента, первичный ключ
cust_name	    text	    название клиента
annual_revenue	numeric	    ежегодная выручка
cust_type	    text	    тип пользователя
address	        text	    адрес
zip	            integer	    почтовый индекс
phone	        text	    телефон
city_id	        integer	    идентификатор города, внешний ключ к таблице city

### Следующая таблица — driver — справочник водителей. Перечень сведений, содержащихся в таблице, представлен ниже.

НАЗВАНИЕ ПОЛЯ	ТИП ДАННЫХ	ОПИСАНИЕ
driver_id	    integer	    уникальный идентификатор водителя, первичный ключ
first_name	    text	    имя водителя
last_name	    text	    фамилия водителя
address	        text	    адрес водителя
zip_code	    integer	    почтовый индекс водителя
phone	        text	    телефон водителя
city_id	        integer	    идентификатор города водителя, внешний ключ к таблице city

### В таблице truck хранится информация о грузовиках, на которых осуществляются перевозки. Данные о них представлены в следующем виде:

НАЗВАНИЕ ПОЛЯ	ТИП ДАННЫХ	ОПИСАНИЕ
truck_id	    integer	    Уникальный идентификатор грузовика, первичный ключ
make	        text	    Производитель грузовика
model_year	    integer	    Дата выпуска грузовика

### Последняя таблица в датасете, shipment, — таблица с данными непосредственно о доставках. Она описывает взаимодействие всех перечисленных сущностей, а потому содержит наибольшее количество ссылок на другие таблицы.

НАЗВАНИЕ ПОЛЯ	ТИП ДАННЫХ	ОПИСАНИЕ
ship_id	        integer	    уникальный идентификатор доставки, первичный ключ
cust_id	        integer	    идентификатор клиента, которому отправлена доставка, внешний ключ к таблице customer
weight	        numeric	    вес посылки
truck_id	    integer	    идентификатор грузовика, на котором отправлена доставка, внешний ключ к таблице truck
driver_id	    integer	    идентификатор водителя, который осуществлял доставку, внешний ключ к таблице driver
city_id	        integer	    идентификатор города в который совершена доставка, внешний ключ к таблице city
ship_date	    date	    дата доставки

### Задание 1.1

- Укажите название города с максимальным весом единичной доставки.
1.  SELECT
2.     c.city_name city_name
3. FROM
4.     sql.shipment s
5. JOIN sql.city c ON s.city_id = c.city_id
6. GROUP BY c.city_id, s.ship_id
7. HAVING COUNT(city_name) = 1
8. ORDER BY s.weight DESC
9. LIMIT 1
### Green Bay
 
- Сколько различных производителей грузовиков перечислено в таблице truck?
1. SELECT
2.    COUNT(DISTINCT make)
3. FROM sql.truck
### 3

- Как зовут водителя (first_name), который совершил наибольшее количество доставок одному клиенту?
1. SELECT
2.     d.first_name first_name,
3.     c.cust_name,
4.     COUNT(c.cust_name) count_cust_name
5. FROM
6.     sql.shipment s
7. JOIN sql.driver d ON s.driver_id = d.driver_id
8. JOIN sql.customer c ON s.cust_id = c.cust_id
9. GROUP BY 1,2
10. ORDER BY 3 DESC
11. LIMIT 1 
### Holger

- Укажите даты первой и последней по времени доставок в таблице shipment.
Ответ введите в формате ДД.ММ.ГГГГ.

Дата первой доставки
1. SELECT
2.     MIN(ship_date)
3. FROM
4.     sql.shipment
### 08.01.2016

Дата последней доставки
1. SELECT
2.     MAX(ship_date)
3. FROM
4.     sql.shipment
### 27.12.2017

- Укажите имя клиента, получившего наибольшее количество доставок за 2017 год.
1. SELECT
2.     c.cust_name cust_name,
3.     c.address address,
4.     COUNT(c.address)
5. FROM
6.     sql.shipment s
7. JOIN sql.customer c ON s.cust_id = c.cust_id
8. JOIN sql.driver d ON s.driver_id = d.driver_id
9. WHERE EXTRACT (YEAR FROM ship_date) = 2017
10. GROUP BY 1,2
11. ORDER BY 3 DESC
12. LIMIT 1
### Autoware Inc