### ПОЧЕМУ ТАК ВАЖЕН ТИП ДАННЫХ?

Как мы уже знаем, UNION может быть использован только в случае полного соответствия столбцов и их типов в объединяемых запросах.

Допустим, мы хотим вывести список всех id городов и их названий в одном столбце.

### ПОПРОБУЙТЕ В METABASE!

Давайте напишем запрос, который позволит получить нужный нам результат.

1. SELECT 
2.          c.city_id /*выбираем столбец city_id*/
3. FROM
4.          sql.city c /*из схемы sql  и таблицы city, задаём таблице алиас с*/ 

5. UNION ALL /*оператор присоединения*/

6. SELECT 
7.          cc.city_name /*выбираем столбец city_name*/
8. FROM
9.          sql.city cc /*из схемы sql и таблицы city, задаём таблице алиас сс*/

Вместо результата вы получите сообщение об ошибке: "ERROR: UNION types integer and text cannot be matched". Дело в том, что мы попытались объединить числовой и строковый типы в одной колонке, а это невозможно.

Если мы всё же хотим выполнить поставленную задачу, придётся привести оба столбца к одному типу данных. Не каждый текст может быть приведён к числу, зато каждое число может быть представлено в текстовом формате.

Забегая вперёд, скажем пару слов о типизации столбцов. Для типизации в Postgres составляется запрос по модели column_name::column_type.

Таким образом, чтобы перевести city_id в текст, нам потребуется написать city_id::text.

### Важно! Любой тип данных может быть приведён к текстовому формату — эту возможность целесообразно использовать для соединения разнородных сущностей. Главное — помнить, что сортировка текста отличается от сортировки чисел и дат.

### ПОПРОБУЙТЕ В METABASE!

1. SELECT 
2.          c.city_id::text /*выбираем столбец city_id, переводим city_id из числового в текстовый формат*/
3. FROM
4.          sql.city c /*из схемы sql  и таблицы city, задаём таблице алиас с*/

5. UNION ALL /*оператор присоединения*/

6. SELECT 
7.          cc.city_name /*выбираем столбец city_name*/
8. FROM
9.          sql.city cc /*из схемы sql и таблицы city, задаём таблице алиас сс*/

### Задание 3.1

Напишите запрос, который объединит в себе все почтовые индексы водителей и их телефоны в единый столбец-справочник. Также добавьте столбец с именем водителя и столбец с типом контакта (phone или zip в зависимости от типа). Столбцы к выводу: contact, first_name, contact_type. 
Отсортируйте список по столбцу с контактными данными в порядке возрастания, а затем — по имени водителя.

1. SELECT
2.     d.zip_code::text contact,
3.     d.first_name first_name,
4.     'zip' contact_type
5. FROM
6.     sql.driver d
7. UNION
8. SELECT
9.     dd.phone contact,
10.     dd.first_name first_name,
11.     'phone' contact_type
12. FROM
13.     sql.driver dd
14. ORDER BY 1,2