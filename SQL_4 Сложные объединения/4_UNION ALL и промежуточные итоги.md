### ВОЗМОЖНОСТИ UNION

Помимо соединения разнородных сущностей в единый справочник, UNION ALL часто используется для подведения промежуточных итогов и выведения результатов агрегатных функций.

Кроме агрегатных функций, в запросах с UNION могут использоваться функции группировки и выборки.

Попробуем вывести обобщённые данные о населении по всем городам, с детализацией до конкретного города.

### ПОПРОБУЙТЕ В METABASE!

1. SELECT
2.          c.city_name,
3.          c.population /*выбираем столбцы city_name, population*/
4. FROM
5.          sql.city c /*из схемы sql и таблицы city, задаём таблице алиас с*/

6. UNION ALL /*оператор присоединения*/

7. SELECT
8.          'total',
9.          SUM(c.population) /*сами задаём объект ‘total’, суммируем все значения столбца population*/
10. FROM
11.          sql.city c /*из схемы sql и таблицы city, задаём таблице алиас с*/
12. ORDER BY 2 DESC /*сортируем по второму столбцу в убывающем порядке (чтобы итоговая сумма была в начале)*/

Выполнив запрос в Metabase, вы заметите, что сначала выведен итоговый результат с суммой населения всех городов в таблице, а затем по каждому городу в отдельности.

### Напишите запрос, который выводит общее число доставок total_shipments, а также количество доставок в каждый день. Необходимые столбцы: date_period, cnt_shipping.

Не забывайте о единой типизации.
Упорядочьте по убыванию столбца date_period.

1. SELECT 
2.     s.ship_date::text date_period, 
3.     COUNT(*) cnt_shipment
4. FROM sql.shipment s 
5. GROUP BY 1
6. UNION ALL
7. SELECT 'total_shipments', 
8.     COUNT(*)
9. FROM sql.shipment s
10. ORDER BY 1 desc