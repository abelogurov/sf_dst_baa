### 1. Получаем все данные из таблицы
Добавить страницу в мои закладки
Как вы помните, данные в БД хранятся в таблицах. В этом модуле мы будем работать с таблицей kinopoisk: она содержит данные о 250 лучших фильмах по версии сервиса «Кинопоиск» (рейтинг собран в мае 2020 года).

Давайте посмотрим на таблицу kinopoisk и изучим, какие данные в ней хранятся:

Название поля	Содержимое
position	номер в базе данных
movie_title	название фильма
year	год выпуска
country	страна выпуска
rating	рейтинг фильма в базе
overview	описание фильма

### ПОПРОБУЙТЕ В METABASE!

SELECT *
FROM sql.kinopoisk

Обратите внимание! Metabase выводит только первые 2 000 строк: в нашем случае таблица полностью уместилась в выводе.

При этом отображена только часть вывода, поскольку не все строки и столбцы влезли на экран. Вы можете увидеть всё содержимое таблицы, прокрутив страницу по вертикали и горизонтали.

Что ещё мы видим? Числа отображаются в американском формате (с десятичным разделителем — точкой и разделителем разрядов — запятой).

Теперь давайте разберём запрос, благодаря которому мы получили такой результат.

### РАЗБИРАЕМ ЗАПРОС

- Оператор SELECT сообщает СУБД, что вы хотите извлечь из неё данные. SELECT лежит в основе любого SQL-запроса к БД.

- FROM sql.kinopoisk сообщает, из какой таблицы извлекаются данные. Сначала указывается название схемы, в которой содержится таблица (в нашем случае — это sql), а после точки — название самой таблицы (kinopoisk).

- Звёздочка * указывает, что вы хотите видеть все столбцы этой таблицы.

Если же вам нужны не все столбцы, а только некоторые, вместо звёздочки перечислите названия всех интересующих вас столбцов через запятую.

### Важно! SQL нечувствителен к регистру, поэтому ключевые слова можно писать хоть строчными, хоть прописными буквами: SELECT, select или SeLeCt.

### Задание 1.1

Напишите запрос, который выведет из таблицы kinopoisk столбцы с названием фильма, годом его выпуска и рейтингом.

Редактор кода

1. SELECT movie_title, year, rating
2. FROM sql.kinopoisk

Независимо от того, в каком порядке представлены столбцы в таблице, в запросе вы можете указывать их в любой очерёдности.

Порядок столбцов в выводе будет совпадать с их расположением после оператора SELECT.

Проведём несколько математических операций с нашим выводом.

### ПОПРОБУЙТЕ В METABASE!

Допустим, вы хотите написать запрос, аналогичный запросу из задания, только вместо года выхода фильма, вам нужен его «возраст» на 2020 год.

В таком случае наш запрос будет выглядеть так:


1. SELECT /*выбор столбцов*/
2.    movie_title, /*столбец movie_title*/
3.    2020 - year, /*столбец, каждое из значений которого ровно разнице 2020 и соответствующего значения столбца year*/
4.    rating /*столбец rating*/
5. FROM sql.kinopoisk /*из таблицы sql.kinopoisk*/
То есть мы отняли от 2020 года год выхода фильма и получили его возраст! Элементарно!

### Задание 1.2

Напишите запрос, который выведет из таблицы kinopoisk следующие столбцы:

имя режиссёра (director),
название фильма (movie_title),
разница между максимально возможным рейтингом (10) и рейтингом этого фильма.
Редактор кода

1. SELECT
2. director,
3. movie_title,
4. 10 - rating
5. FROM sql.kinopoisk

### ПОПРОБУЙТЕ В METABASE!

Для этого используем ключевое слово AS и поставим после него новое имя difference. Можем повторить этот процесс для каждого столбца.

1. SELECT /*выбрать столбцы*/
2.    director, /*столбец director*/
3.    movie_title, /*столбец movie_title*/
4.    10 - rating AS difference /*столбец, значения в котором равны разнице 10 и каждого соответствующего значения столбца rating; присвоить столбцу алиас difference*/
5. FROM sql.kinopoisk /*из таблицы sql.kinopoisk*/

Новое имя является просто псевдонимом, или алиасом, — оно временное и не меняет реального имени столбца в базе данных. Алиас влияет только на то, как столбец отображается в выводе конкретного запроса.

Алиасом может быть как одно слово, так и несколько, а его написание — как латиницей, так и кириллицей.

### Обратите внимание! Если в алиасе используется кириллица или пробелы, необходимо заключать его в двойные кавычки: 10 - rating AS "разница" или movie_title AS "Movie Title".

### Будьте внимательны! При выполнении заданий в рамках курса используйте алиасы аккуратно. Если в задаче не указано, какое имя нужно присвоить столбцу, значит, его нужно выводить под тем же названием, что дано ему в таблице.

### ПРОСТЫЕ ОПЕРАЦИИ С ДАННЫМИ

Со столбцами, которые содержат числовые данные, можно проводить арифметические операции:

- сложение с помощью + ;
- вычитание с помощью - (этот тип операции вы уже проводили, когда определяли «возраст» фильма);
- умножение с помощью * ;
- деление с помощью / ;

### Важно! Если и числитель, и знаменатель — целые числа, результат деления также будет целочисленным, то есть этот оператор произведёт деление нацело.

### получение остатка от деления с помощью % .

### ДОПОЛНИТЕЛЬНО

С полным перечнем доступных арифметических операций вы можете ознакомиться в официальной документации.

### Задание 1.3

Напишите запрос, который выведет столбцы с именем режиссёра, названием фильма, рейтингом по 100-балльной шкале (столбец rating_100).

Рейтинг по 100-балльной шкале определите как оценку по 10-балльной, умноженную на 10.

1. SELECT   
2.    director,
3.    movie_title,
4.    rating*10 as rating_100
5. FROM sql.kinopoisk

Также мы можем проводить арифметические операции с несколькими столбцами.

### ПОПРОБУЙТЕ В METABASE!

Давайте выведем для каждого фильма результат деления года его выпуска на рейтинг (что бы это ни значило :)).

1. SELECT /*выбрать столбцы*/
2.    movie_title, /*столбец movie_title*/
3.    year / rating /*столбец, значения которого равны результату деления значений столбца year на соответствующие значения столбца rating*/
4. FROM sql.kinopoisk /*из таблицы sql.kinopoisk*/