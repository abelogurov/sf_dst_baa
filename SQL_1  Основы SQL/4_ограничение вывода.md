4. Ограничение вывода
Добавить страницу в мои закладки
LIMIT

По умолчанию при любом запросе вы получаете в выводе все строки, попадающие под условия запроса.

Чаще всего именно этого вы и ожидаете, но иногда, например, вам нужно просто взглянуть на содержание таблицы, при этом чем она она больше, тем дольше будет работать запрос.

### ПОПРОБУЙТЕ В METABASE!

Ограничим вывод первыми десятью строками и сможем легко понять, какие данные хранятся в таблице, не утяжеляя результат.

1. SELECT * /*выбор всех полей*/
2. FROM sql.kinopoisk /*из таблицы sql.kinopoisk*/
3. LIMIT 10 /*ограничить вывод десятью значениями*/

Ещё один типичный случай использования ограничения вывода — вывод ТОПа по какому-то показателю.

### ПОПРОБУЙТЕ В METABASE!

Выведем ТОП-5 фильмов по рейтингу, сначала отсортировав их по убыванию, а потом оставив только верхние пять строк с помощью LIMIT.

1. SELECT /*выбор*/
2.     movie_title, /*столбец movie_title*/
3.     rating /*столбец rating*/
4. FROM sql.kinopoisk /*из таблицы sql.kinopoisk*/
5. ORDER BY rating DESC /*сортировка по столбцу rating в порядке убывания*/
6. LIMIT 5 /*ограничить пятью значениями*/

Обратите внимание! Ключевое слово LIMIT используется в самом конце запроса.

### Задание 4.1

Напишите запрос, который выводит ТОП-20 самых старых (определяем по году выхода в прокат) фильмов из таблицы kinopoisk.

1. SELECT
2.     director as "Режессёр",
3.     movie_title as "Название фильма",
4.     actors as "Актёры"
5. FROM sql.kinopoisk 
6. ORDER BY year
7. LIMIT 20

### OFFSET

Если LIMIT «оставляет» указанное число первых строк из вывода, то OFFSET, наоборот, «обрезает» указанное число первых строк.

LIMIT и OFFSET можно использовать вместе, их порядок не важен.

### ПОПРОБУЙТЕ В METABASE!

Выведем название и рейтинг фильмов с четвёртого по восьмое место.

1. SELECT /*выбор*/
2.     movie_title, /*столбец movie_title*/
3.     rating /*столбец rating*/
4. FROM sql.kinopoisk /*из таблицы sql.kinopoisk*/
5. ORDER BY rating DESC /*сортировка по столбцу rating в порядке убывания*/
6. OFFSET 3 LIMIT 5 /*исключить первые три строки и вывести пять следующих за ними*/

Таким образом, LIMIT отсчитывает количество строк после указанной в OFFSET строки.

Задание 4.2

Напишите запрос, чтобы вывести названия фильмов, которые вышли в прокат после 1990 года и были сняты не в России. Из этого списка оставьте только те фильмы, которые занимают с 20 по 47 места в рейтинге.

Отсортируйте результат по убыванию рейтинга фильмов.

1. SELECT
2.     movie_title
3. FROM sql.kinopoisk 
4. WHERE year > 1990 AND country != 'Россия'
5. ORDER BY rating DESC
6. OFFSET 19 LIMIT 28