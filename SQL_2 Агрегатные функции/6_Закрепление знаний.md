### 6. Итоги

Итак, каковы наши успехи в этом модуле?

Вы познакомились с агрегатными функциями и научились:

- считать количество строк, сумму, минимум, максимум, среднее по значениям таблицы;
- выводить агрегированные значения в разных разрезах;
- фильтровать по агрегированным значениям.

И в довершение итогов напомним структуру запроса, который мы можем составить с учётом новых знаний:

1. SELECT
2.     столбец1 AS новое_название,
3.     столбец2,
4.     АГРЕГАТ(столбец3)
5. FROM таблица
6. WHERE (условие1 OR условие2)
7.     AND условие3
8. GROUP BY столбец1, столбец2
9. HAVING АГРЕГАТ(столбец3) > 5
10. ORDER BY сортировка1, сортировка2
11. OFFSET 1 LIMIT 2

### Ищим Пикачу

1. SELECT
2.     name,
3.     type1,
4.     type2,
5.     attack,
6.     hp,
7.     defense
8. FROM sql.pokemon
9. WHERE name LIKE 'Pi%' AND type1 LIKE 'Electric'
10. GROUP BY 1,2,3,4,5,6
11. ORDER BY name

### Задание 6.1

Сколько различных значений показателей атаки есть у покемонов с типом Water (основным или дополнительным)?

1. select
2.     count(distinct attack)
3. from sql.pokemon
4. where (type1 = 'Water' or type2 = 'Water')
5.      and attack is not null

### Задание 6.2

Напишите запрос, который выведет основной и дополнительный типы покемонов и средние значения по каждому показателю (столбцы avg_hp, avg_attack, avg_defense, avg_speed).
Оставьте только те пары типов, у которых сумма этих четырёх показателей более 400.

1. select
2.     type1 as primary_type,
3.     type2 as additional_type,
4.     avg(hp) as avg_hp,
5.     avg(attack) as avg_attack, 
6.     avg(defense) as avg_defense, 
7.     avg(speed) as avg_speed
8. from sql.pokemon
9. group by 1,2
10. having avg(hp) + avg(attack) + avg(defense) + avg(speed) > 400

### Задание 6.3

Напишите запрос, который выведет столбцы с основным типом покемона и общим количеством покемонов этого типа.
Учитывайте только тех покемонов, у которых или показатель атаки, или показатель защиты принимает значение между 50 и 100 включительно.
Оставьте только те типы покемонов, у которых максимальный показатель здоровья не больше 125.
Выведите только тот тип, который находится на пятом месте по количеству покемонов.

1. SELECT
2.     type1, 
3.     COUNT(*)
4. FROM sql.pokemon
5. WHERE attack BETWEEN 50 AND 100 OR defense BETWEEN 50 AND 100
6. GROUP BY type1
7. HAVING MAX(hp) <= 125
8. ORDER BY COUNT(*) DESC
9. LIMIT 1 OFFSET 4